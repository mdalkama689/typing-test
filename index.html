<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Typing Speed Test</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    /* Add box-sizing for easier layout management */
  }

  body {
    background-color: #181818;
    /* Dark background */
    font-family: sans-serif;
    /* A clean, readable font */
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    /* Ensure the body takes up the full viewport height */
  }

  .main-container {
    background-color: #282828;
    /* Slightly lighter dark background for the container */
    color: #f0f0f0;
    /* Light text color */
    border-radius: 12px;
    padding: 30px;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
    width: 90%;
    max-width: 800px;
    /* Limit the maximum width of the container */
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .main-heading {
    color: #f0f0f0;
    text-align: center;
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 20px;
  }

  .feature-container {
    display: flex;
    justify-content: space-around;
    /* Distribute space evenly */
    align-items: center;
    gap: 20px;
    width: 100%;
    margin-bottom: 25px;
  }

  .time-stamp-container,
  .accuracy-container,
  .wpm-container,
  .cpm-container {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .time-stamp-container p:first-of-type,
  .accuracy-container p:first-of-type,
  .wpm-container p:first-of-type,
  .cpm-container p:first-of-type {
    color: #00ffcc;
    /* Highlight color for numbers */
    font-size: 2.5rem;
    font-weight: 600;
    margin-bottom: 5px;
  }

  .time-stamp-container p:last-of-type,
  .accuracy-container p:last-of-type,
  .wpm-container p:last-of-type,
  .cpm-container p:last-of-type {
    color: #e0e0e0;
    font-size: 0.9rem;
    text-transform: uppercase;
  }

  .typing-box {
    background-color: #333;
    border: 1px solid #555;
    padding: 20px;
    border-radius: 8px;
    width: 100%;
    /* Make the typing box take full width */
    font-size: 1.1rem;
    line-height: 1.6;
    cursor: text;
    position: relative;
    white-space: pre-wrap;
    min-height: 120px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 20px;
  }

  #text-display {
    width: 100%;
    white-space: pre-wrap;
  }

  .char {
    color: #aaa;
  }

  .correct {
    color: #fff;
  }

  .incorrect {
    color: #f87171;
  }

  .current {
    color: #00ffcc;
    /* Highlight the current character */
    text-decoration: underline;
    animation: blink 1s infinite;
  }

  @keyframes blink {

    0%,
    100% {
      opacity: 1;
    }

    50% {
      opacity: 0;
    }
  }

  input#hidden-input {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    caret-color: transparent;
    /* Hide the default text input caret */
  }

  .second-main-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    width: 100%;
    margin-bottom: 20px;
  }

  .music-container {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  #bgMusic {
    display: none;
    /* Keep it hidden */
  }

  .toggle-container {
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: bold;
  }

  .switch {
    position: relative;
    display: inline-block;
    width: 40px;
    height: 22px;
  }

  .switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: 0.4s;
    border-radius: 34px;
  }

  .slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 4px;
    bottom: 3px;
    background-color: white;
    transition: 0.4s;
    border-radius: 50%;
  }

  input:checked+.slider {
    background-color: #00ffcc;
  }

  input:checked+.slider:before {
    transform: translateX(18px);
  }

  .restart-btn {
    background-color: #eee;
    color: #333;
    padding: 10px 20px;
    font-size: 1rem;
    font-weight: 600;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  .restart-btn:hover {
    background-color: #ddd;
  }

  select {
    background-color: #333;
    color: #00ffcc;
    padding: 10px 16px;
    font-size: 1rem;
    font-weight: bold;
    border: 1px solid #00ffcc;
    border-radius: 6px;
    outline: none;
    appearance: none;
    cursor: pointer;
    transition: border-color 0.3s ease;
    position: relative;
  }

  select::after {
    content: 'â–¼';
    color: #00ffcc;
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
  }

  select:hover {
    border-color: #00cc99;
  }

  .result-container {
    background-color: #444;
    color: #f0f0f0;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    width: 90%;
    max-width: 500px;
    display: none;
    /* Hidden by default */
    flex-direction: column;
    align-items: center;
    text-align: center;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  .result-img {
    max-width: 150px;
    margin-bottom: 15px;
  }

  .result-container p {
    font-weight: 400;
    font-size: 1rem;
    line-height: 1.5;
    margin-bottom: 10px;
  }

  .result-container p:first-child {
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 5px;
  }

  .result-container span {
    color: #00ffcc;
    font-weight: bold;
  }

  .fa-xmark {
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
    font-size: 1.2rem;
    color: #ccc;
    transition: color 0.2s ease;
  }

  .fa-xmark:hover {
    color: #eee;
  }
</style>

<body>
  <div class="main-container">
    <p class="main-heading">Test your typing skills</p>

    <div class="feature-container">
      <div class="time-stamp-container">
        <p class="time-in-second">30</p>
        <p>seconds</p>
      </div>
      <div class="accuracy-container">
        <p id="accuracy">0</p>
        <p>%Accuracy</p>
      </div>

      <div class="wpm-container">
        <p id="wpm">0</p>
        <p>WPM</p>
      </div>

      <div class="cpm-container">
        <p id="cpm">0</p>
        <p>CPM</p>
      </div>
    </div>

    <div class="second-main-container">
      <div class="music-container">
        <audio controls autoplay loop id="bgMusic">
          <source src="music.mp3" />
        </audio>
        <div class="toggle-container">
          <label class="switch">
            <input type="checkbox" id="toggleBtn">
            <span class="slider"></span>
          </label>
          <span id="status" style="color: white;">Music OFF</span>
        </div>
      </div>

      <div>
        <button class="restart-btn">Restart</button>
      </div>

      <div>
        <select name="select-time-duration" id="select-time-duration">
          <option value="30">30s</option>
          <option value="60">60s</option>
          <option value="90">90s</option>
        </select>
      </div>
    </div>

    <div class="typing-box" id="typing-box">
      <input type="text" id="hidden-input" autocomplete="off" autofocus />
      <div id="text-display"></div>
    </div>

    <!-- result container -->
    <div class="result-container">
      <img class="result-img" src="" alt="">
      <div>
        <p>You're a <span class="result-tag"></span></p>
        <p>Well... You type with the speed of <br> <span class="result-wpm">28 WPM</span> <span class="result-cpm">(124
            CPM)</span>. Your accuracy <br> was <span class="result-accuracy"> 77%</span>. It could be better!</p>

        <i class="fa-solid fa-xmark"></i>
      </div>
    </div>
    <p style="font-size:14px; color:#ccc;">
      Why does real-time WPM/CPM differ from the final result? 
      <a target="_blank" href="https://www.notion.so/1da07337b4a180b7bb41f8981342f554?pvs=4" style="color:#4dabf7; text-decoration:none;">Find out</a>
    </p>
    
  </div>

  <script>
    const timerDisplay = document.querySelector(".time-in-second");
    const input = document.getElementById("hidden-input");
    const typingBox = document.getElementById("typing-box");
    const textDisplay = document.getElementById("text-display");
    const restartBtn = document.querySelector(".restart-btn");
    const accuracySpan = document.getElementById("accuracy");
    const wpmSpan = document.getElementById("wpm");
    const cpmSpan = document.getElementById("cpm");
    const timeDurationOption = document.querySelector("#select-time-duration");
    const result = document.querySelector(".result-container");
    const resultTag = document.querySelector(".result-tag");
    const resultWpm = document.querySelector(".result-wpm");
    const resultCpm = document.querySelector(".result-cpm");
    const resultAccuracy = document.querySelector(".result-accuracy");
    const resultImg = document.querySelector(".result-img")

    const slothImg    = "https://cdn-icons-png.flaticon.com/512/616/616408.png"; // Sloth
const tortoiseImg = "https://cdn-icons-png.flaticon.com/512/1998/1998592.png"; // Tortoise
const hedgehogImg = "https://cdn-icons-png.flaticon.com/512/1998/1998642.png"; // Hedgehog
const rabbitImg   = "https://cdn-icons-png.flaticon.com/512/616/6164087.png"; // Rabbit
const horseImg    = "https://cdn-icons-png.flaticon.com/512/3535/3535445.png"; // Horse
const tigerImg    = "https://cdn-icons-png.flaticon.com/512/616/6164089.png"; // Tiger
const cheetahImg  = "https://cdn-icons-png.flaticon.com/512/7674/7674626.png"; // Cheetah
const pantherImg  = "https://cdn-icons-png.flaticon.com/512/8022/8022786.png"; // Panther
const eagleImg    = "https://cdn-icons-png.flaticon.com/512/616/6164307.png"; // Eagle
const hawkImg     = "https://cdn-icons-png.flaticon.com/512/2924/2924449.png"; // Hawk
const flashImg    = "https://cdn-icons-png.flaticon.com/512/2107/2107957.png"; // Flash (lightning bolt)


    let timer = parseInt(timerDisplay.textContent);
    let timeInterval;
    let timerStarted = false;
    let startTime = null;

    function getResultTag(wpm) {
      if (wpm < 10) return "Sloth";
      if (wpm < 20) return "Tortoise";
      if (wpm < 30) return "Hedgehog";
      if (wpm < 40) return "Rabbit";
      if (wpm < 50) return "Horse";
      if (wpm < 60) return "Tiger";
      if (wpm < 70) return "Cheetah";
      if (wpm < 80) return "Panther";
      if (wpm < 90) return "Eagle";
      if (wpm < 100) return "Hawk";
      return "Flash";
    }
    function getResultImg(wpm) {
      if (wpm < 10) return slothImg;
  if (wpm < 20) return tortoiseImg;
  if (wpm < 30) return hedgehogImg;
  if (wpm < 40) return rabbitImg;
  if (wpm < 50) return horseImg;
  if (wpm < 60) return tigerImg;
  if (wpm < 70) return cheetahImg;
  if (wpm < 80) return pantherImg;
  if (wpm < 90) return eagleImg;
  if (wpm < 100) return hawkImg;
  return flashImg;
    }


    const wordPool = [
      "apple",
      "banana",
      "grape",
      "orange",
      "kiwi",
      "pineapple",
      "mango",
      "peach",
      "plum",
      "pear",
      "watermelon",
      "melon",
      "cherry",
      "blueberry",
      "strawberry",
      "lemon",
      "apricot",
      "kiwi",
      "fruit",
      "delicious",
      "sweet",
      "tasty",
      "healthy",
      "smoothie",
      "juice",
      "tart",
      "sour",
      "fresh",
    ];

    let currentText = "";
    let userInput = "";

    function generateRandomSentence() {
      const sentenceLength = Math.floor(Math.random() * (10 - 5 + 1)) + 5;
      let randomSentence = [];

      for (let i = 0; i < sentenceLength; i++) {
        const randomWord = wordPool[Math.floor(Math.random() * wordPool.length)];
        randomSentence.push(randomWord);
      }

      return randomSentence.join(" ");
    }

    function generateRandomText() {
      let randomText = "";
      for (let i = 0; i < 1; i++) {
        randomText += generateRandomSentence() + "\n";
      }
      return randomText;
    }

    function loadNewText() {
      currentText = generateRandomText();
      userInput = "";
      input.value = "";
      renderText();
    }

    function renderText() {
      textDisplay.innerHTML = "";
      for (let i = 0; i < currentText.length; i++) {
        const span = document.createElement("span");
        span.classList.add("char");

        if (i < userInput.length) {
          span.textContent = currentText[i];
          if (userInput[i] === currentText[i]) {
            span.classList.add("correct");
          } else {
            span.classList.add("incorrect");
          }
        } else {
          span.textContent = currentText[i];
          if (i === userInput.length) {
            span.classList.add("current");
          }
        }

        textDisplay.appendChild(span);
      }
    }

    function startTimer() {
      if (timerStarted) return;

      timerStarted = true;
      startTime = new Date();

      timeInterval = setInterval(() => {
        if (timer > 0) {
          timer--;
          timerDisplay.textContent = timer;
          timeDurationOption.disabled = true;
        } else {
          clearInterval(timeInterval);
          userInput = input.value;
          renderText();

          input.disabled = true;
          timeDurationOption.disabled = false;
          const acc = calculateAccuracy();
          const wpm = calculateWPM();
          const cpm = calculateCPM();
          const tag = getResultTag(wpm);
          const img = getResultImg(wpm)
          resultImg.src = img

          resultTag.textContent = tag;
          resultWpm.textContent = `${wpm} WPM`;
          resultCpm.textContent = `(${cpm} CPM)`;
          resultAccuracy.textContent = `${acc}%`;

          result.style.display = "flex";
        }
      }, 1000);
    }

    function calculateAccuracy() {
      let correct = 0;
      for (let i = 0; i < userInput.length; i++) {
        if (userInput[i] === currentText[i]) {
          correct++;
        }
      }

      const totalTyped = userInput.length;
      const accuracy = totalTyped === 0 ? 0 : (correct / totalTyped) * 100;
      return Math.round(accuracy);
    }

    function calculateWPM() {
      const now = new Date();
      const seconds = (now - startTime) / 1000;
      const wordCount = userInput.trim().split(/\s+/).length;
      const wpm = seconds === 0 ? 0 : (wordCount / seconds) * 60;
      return Math.floor(wpm);
    }

    function calculateCPM() {
      const now = new Date();
      const seconds = (now - startTime) / 1000;
      const characterCount = userInput.length;
      const cpm = seconds === 0 ? 0 : (characterCount / seconds) * 60;
      return Math.floor(cpm);
    }

    input.addEventListener("input", (e) => {
      if (!timerStarted) startTimer();

      userInput = e.target.value;
      renderText();

      if (userInput.endsWith(" ")) {
        const acc = calculateAccuracy();
        const wpm = calculateWPM();
        const cpm = calculateCPM();

        accuracySpan.textContent = acc;
        wpmSpan.textContent = wpm;
        cpmSpan.textContent = cpm;
      }

      if (userInput.length === currentText.length) {
        setTimeout(() => {
          loadNewText();
        }, 200);
      }
    });

    typingBox.addEventListener("click", () => {
      input.focus();
    });

    function updateTimer() {
      timer = parseInt(timeDurationOption.value);
      timerDisplay.textContent = timer;
    }

    timeDurationOption.addEventListener("change", updateTimer);

    restartBtn.addEventListener("click", () => {
      clearInterval(timeInterval);
      updateTimer();
      input.disabled = false;
      timerStarted = false;
      startTime = null;
      input.value = "";
      accuracySpan.textContent = 0;
      wpmSpan.textContent = 0;
      cpmSpan.textContent = 0;
      loadNewText();
    });

    loadNewText();

    const bgMusic = document.querySelector("#bgMusic");

    const toggle = document.getElementById("toggleBtn");
    const statusText = document.getElementById("status");

    toggle.addEventListener("change", () => {
      statusText.textContent = toggle.checked ? "Music ON" : "Music OFF";
      if (toggle.checked) {
        bgMusic.play();
      } else {
        bgMusic.pause();
      }
    });

    const closeBtn = document.querySelector(".fa-xmark");

    closeBtn.addEventListener("click", () => {
      result.style.display = "none";
    });



  </script>
</body>

</html>